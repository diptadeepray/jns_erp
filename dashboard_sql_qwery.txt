SELECT 
    venture_id,
    expected_material_expense,
    actual_sitewise_material_expense,
    supplier_difference,
    expected_sitewise_labour_expense,
    actual_sitewise_actual_labour_expense,
    contractor_difference
FROM (
    SELECT 
        actual_supplier.venture_id AS venture_id,

        expected_supplier.supplier_total AS expected_material_expense,
        actual_supplier.supplier_total AS actual_sitewise_material_expense,
        (expected_supplier.supplier_total - actual_supplier.supplier_total)
            AS supplier_difference,

        expected_contractor.contractor_total AS expected_sitewise_labour_expense,
        actual_contractor.contractor_total AS actual_sitewise_actual_labour_expense,
        (expected_contractor.contractor_total - actual_contractor.contractor_total)
            AS contractor_difference

   FROM (
    SELECT 
        actual_supplier.venture_id AS venture_id,

        expected_supplier.supplier_total AS expected_material_expense,
        actual_supplier.supplier_total AS actual_sitewise_material_expense,
        (expected_supplier.supplier_total - actual_supplier.supplier_total)
            AS supplier_difference,

        expected_contractor.contractor_total AS expected_sitewise_labour_expense,
        actual_contractor.contractor_total AS actual_sitewise_actual_labour_expense,
        (expected_contractor.contractor_total - actual_contractor.contractor_total)
            AS contractor_difference

    FROM 
        (SELECT venture_id, SUM(expected_material_expense) AS supplier_total
         FROM expected_ap
         GROUP BY venture_id) AS expected_supplier

    INNER JOIN
        (SELECT venture_id, SUM(total_amount) AS supplier_total
         FROM outbound_payments
         WHERE supplier_id IS NOT NULL
         GROUP BY venture_id) AS actual_supplier
    ON actual_supplier.venture_id = expected_supplier.venture_id

    INNER JOIN
        (SELECT venture_id, SUM(expected_labour_expense) AS contractor_total
         FROM expected_ap
         GROUP BY venture_id) AS expected_contractor
    ON expected_contractor.venture_id = expected_supplier.venture_id

    INNER JOIN
        (SELECT venture_id, SUM(total_amount) AS contractor_total
         FROM outbound_payments
         WHERE contractor_id IS NOT NULL
         GROUP BY venture_id) AS actual_contractor
    ON actual_contractor.venture_id = expected_supplier.venture_id
)
UNION ALL

SELECT
    'TOTAL',
    SUM(expected_material_expense),
    SUM(actual_sitewise_material_expense),
    SUM(supplier_difference),
    SUM(expected_sitewise_labour_expense),
    SUM(actual_sitewise_actual_labour_expense),
    SUM(contractor_difference)
FROM (
    SELECT 
        actual_supplier.venture_id AS venture_id,

        expected_supplier.supplier_total AS expected_material_expense,
        actual_supplier.supplier_total AS actual_sitewise_material_expense,
        (expected_supplier.supplier_total - actual_supplier.supplier_total)
            AS supplier_difference,

        expected_contractor.contractor_total AS expected_sitewise_labour_expense,
        actual_contractor.contractor_total AS actual_sitewise_actual_labour_expense,
        (expected_contractor.contractor_total - actual_contractor.contractor_total)
            AS contractor_difference

    FROM 
        (SELECT venture_id, SUM(expected_material_expense) AS supplier_total
         FROM expected_ap
         GROUP BY venture_id) AS expected_supplier

    INNER JOIN
        (SELECT venture_id, SUM(total_amount) AS supplier_total
         FROM outbound_payments
         WHERE supplier_id IS NOT NULL
         GROUP BY venture_id) AS actual_supplier
    ON actual_supplier.venture_id = expected_supplier.venture_id

    INNER JOIN
        (SELECT venture_id, SUM(expected_labour_expense) AS contractor_total
         FROM expected_ap
         GROUP BY venture_id) AS expected_contractor
    ON expected_contractor.venture_id = expected_supplier.venture_id

    INNER JOIN
        (SELECT venture_id, SUM(total_amount) AS contractor_total
         FROM outbound_payments
         WHERE contractor_id IS NOT NULL
         GROUP BY venture_id) AS actual_contractor
    ON actual_contractor.venture_id = expected_supplier.venture_id
);
